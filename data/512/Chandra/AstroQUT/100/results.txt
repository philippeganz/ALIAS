WS test with 512x512 Chandra data.
Computing beta0...
beta0 = 1.219881e-09
Computing standardization matrix...
100/100
Computing lambda and lambdaI...
100/100
lambda = 1.910579e+00
lambdaI = 3.889333e+07
************************************* FISTA ************************************
A : 262144x263168 matrix, u : 262144 vector, b : 262144 vector
lambda :1.91058, tol :1e-10
********************************************************************************

 iter |          tol         |        FLasso        |      Lf       |  lambda
--------------------------------------------------------------------------------
   10 |    -1.8437262020e-01 |    -1.2931189099e+06 |             8 | 1.910579176
   20 |    -7.6412181298e-03 |    -1.3184355010e+06 |             8 | 1.910579176
   30 |    -1.9660325248e-03 |    -1.3239173901e+06 |             4 | 1.910579176
   40 |    -1.0535651352e-03 |    -1.3268412856e+06 |             4 | 1.910579176
   50 |    -7.0066518560e-04 |    -1.3285732226e+06 |             4 | 1.910579176
   60 |    -4.2411427190e-04 |    -1.3296396006e+06 |             4 | 1.910579176
   70 |    -3.6596358656e-04 |    -1.3305692677e+06 |            16 | 1.910579176
   80 |    -2.7777961235e-04 |    -1.3312636636e+06 |             8 | 1.910579176
   90 |    -1.8944739276e-04 |    -1.3317359619e+06 |             8 | 1.910579176
  100 |    -1.6346005340e-04 |    -1.3321441186e+06 |             1 | 1.910579176
  110 |    -1.4748261095e-04 |    -1.3325385938e+06 |             8 | 1.910579176
  120 |    -1.3430724824e-04 |    -1.3328739041e+06 |             4 | 1.910579176
  130 |    -1.2595027317e-04 |    -1.3331770664e+06 |             4 | 1.910579176
  140 |    -1.1607004824e-04 |    -1.3334548223e+06 |             4 | 1.910579176
  150 |    -1.0796155838e-04 |    -1.3337097957e+06 |             4 | 1.910579176
  160 |    -1.0027373689e-04 |    -1.3339472190e+06 |             4 | 1.910579176
  170 |    -9.3967444543e-05 |    -1.3341687420e+06 |             4 | 1.910579176
  180 |    -8.4607165143e-05 |    -1.3343737079e+06 |             4 | 1.910579176
  190 |    -9.3397917243e-05 |    -1.3345903923e+06 |             2 | 1.910579176
  200 |    -8.3660828086e-05 |    -1.3348015516e+06 |             1 | 1.910579176
  210 |    -8.0626056183e-05 |    -1.3349869303e+06 |             2 | 1.910579176
  220 |    -8.1514280774e-05 |    -1.3351737519e+06 |             4 | 1.910579176
  230 |    -5.9731645587e-05 |    -1.3353173645e+06 |             4 | 1.910579176
  240 |    -5.7539820749e-05 |    -1.3354585525e+06 |             4 | 1.910579176
  250 |    -5.4943577387e-05 |    -1.3355894103e+06 |             4 | 1.910579176
  260 |    -5.0174639096e-05 |    -1.3357108969e+06 |             8 | 1.910579176
  270 |    -6.0490309979e-05 |    -1.3358574683e+06 |             8 | 1.910579176
  280 |    -4.5695501823e-05 |    -1.3359704836e+06 |             4 | 1.910579176
  290 |    -4.1008625606e-05 |    -1.3360715085e+06 |             4 | 1.910579176
  300 |    -3.8994943111e-05 |    -1.3361745243e+06 |             1 | 1.910579176
  310 |    -3.7934888614e-05 |    -1.3362670282e+06 |             8 | 1.910579176
  320 |    -4.3140274201e-05 |    -1.3363679665e+06 |             8 | 1.910579176
  330 |    -3.8335437907e-05 |    -1.3364677289e+06 |             4 | 1.910579176
  340 |    -4.2300997247e-05 |    -1.3365655891e+06 |             2 | 1.910579176
  350 |    -9.4177347611e-05 |    -1.3367595405e+06 |             8 | 1.910579176
  360 |    -4.9065568189e-05 |    -1.3368588142e+06 |             1 | 1.910579176
  370 |    -3.9219979418e-05 |    -1.3369595049e+06 |             2 | 1.910579176
  380 |    -2.6647905135e-05 |    -1.3370259040e+06 |             8 | 1.910579176
  390 |    -4.8188386667e-05 |    -1.3371285833e+06 |             1 | 1.910579176
  400 |    -4.9457943237e-05 |    -1.3372314984e+06 |             1 | 1.910579176
  410 |    -2.1951116669e-05 |    -1.3372848094e+06 |             4 | 1.910579176
  420 |    -3.1426225998e-05 |    -1.3373687644e+06 |             4 | 1.910579176
  430 |    -3.7999624530e-05 |    -1.3374615935e+06 |             2 | 1.910579176
  440 |    -2.8660601069e-05 |    -1.3375498467e+06 |             8 | 1.910579176
  450 |    -3.3298853829e-05 |    -1.3376192719e+06 |             1 | 1.910579176
  460 |    -4.4920028529e-05 |    -1.3377409835e+06 |             4 | 1.910579176
  470 |    -2.2472566666e-05 |    -1.3377941316e+06 |             8 | 1.910579176
  480 |    -2.5595080894e-05 |    -1.3378634026e+06 |             2 | 1.910579176
  490 |    -3.1519434664e-05 |    -1.3379267289e+06 |             1 | 1.910579176

 iter |          tol         |        FLasso        |      Lf       |  lambda
--------------------------------------------------------------------------------
  500 |    -3.2388019657e-05 |    -1.3379922466e+06 |             1 | 1.910579176
  510 |    -3.0056151542e-05 |    -1.3380632321e+06 |             4 | 1.910579176
  520 |    -3.0724625069e-05 |    -1.3381251907e+06 |             2 | 1.910579176
  530 |    -2.0295332964e-05 |    -1.3381697734e+06 |             2 | 1.910579176
  540 |    -3.7948607200e-05 |    -1.3382590880e+06 |             4 | 1.910579176
  550 |    -1.6038834963e-05 |    -1.3382987085e+06 |             4 | 1.910579176
  560 |    -2.1648098179e-05 |    -1.3383462575e+06 |            16 | 1.910579176
  570 |    -1.4115945744e-05 |    -1.3383818148e+06 |             4 | 1.910579176
  580 |    -3.3043113080e-05 |    -1.3384543776e+06 |             8 | 1.910579176
  590 |    -1.3445018366e-05 |    -1.3384900839e+06 |             4 | 1.910579176
  600 |    -2.1567506586e-05 |    -1.3385484354e+06 |             1 | 1.910579176
  610 |    -1.2560471839e-05 |    -1.3385800393e+06 |             4 | 1.910579176
  620 |    -1.6640318373e-05 |    -1.3386218896e+06 |             4 | 1.910579176
  630 |    -1.7464630308e-05 |    -1.3386692414e+06 |             4 | 1.910579176
  640 |    -1.5367614939e-05 |    -1.3387074555e+06 |             8 | 1.910579176
  650 |    -2.1512293510e-05 |    -1.3387710447e+06 |             8 | 1.910579176
  660 |    -2.8662757398e-05 |    -1.3388340547e+06 |             4 | 1.910579176
  670 |    -4.3828547730e-05 |    -1.3389299352e+06 |             4 | 1.910579176
  680 |    -1.0510461964e-05 |    -1.3389567763e+06 |             4 | 1.910579176
  690 |    -1.4415806710e-05 |    -1.3389923580e+06 |             2 | 1.910579176
  700 |    -2.0761514964e-05 |    -1.3390747089e+06 |             1 | 1.910579176
  710 |    -1.4056361746e-05 |    -1.3391143783e+06 |             8 | 1.910579176
  720 |    -1.1058087671e-05 |    -1.3391411789e+06 |             2 | 1.910579176
  730 |    -1.9777701046e-05 |    -1.3391919302e+06 |             8 | 1.910579176
  740 |    -1.7330854537e-05 |    -1.3392401398e+06 |             2 | 1.910579176
  750 |    -2.2697276025e-05 |    -1.3392852530e+06 |             4 | 1.910579176
  760 |    -9.8551296546e-06 |    -1.3393106478e+06 |             8 | 1.910579176
  770 |    -1.7986069771e-05 |    -1.3393531399e+06 |             8 | 1.910579176
  780 |    -1.8315329307e-05 |    -1.3393958918e+06 |             4 | 1.910579176
  790 |    -2.0129630269e-05 |    -1.3394378899e+06 |             2 | 1.910579176
  800 |    -9.2698648487e-06 |    -1.3394610920e+06 |             1 | 1.910579176
  810 |    -9.7243367174e-06 |    -1.3394850056e+06 |             8 | 1.910579176
  820 |    -1.3624848349e-05 |    -1.3395141974e+06 |             1 | 1.910579176
  830 |    -1.2181749803e-05 |    -1.3395526049e+06 |            16 | 1.910579176
  840 |    -9.4535894541e-06 |    -1.3395759090e+06 |             4 | 1.910579176
  850 |    -8.9321693690e-06 |    -1.3395978638e+06 |             4 | 1.910579176
  860 |    -9.5549313356e-06 |    -1.3396206496e+06 |             2 | 1.910579176
  870 |    -9.0074518364e-06 |    -1.3396425424e+06 |             4 | 1.910579176
  880 |    -8.6742323640e-06 |    -1.3396638540e+06 |             4 | 1.910579176
  890 |    -1.0046459573e-05 |    -1.3396867713e+06 |             1 | 1.910579176
  900 |    -7.6694105706e-06 |    -1.3397057692e+06 |             1 | 1.910579176
  910 |    -8.4077156694e-06 |    -1.3397323366e+06 |             2 | 1.910579176
  920 |    -1.4828041133e-05 |    -1.3397619829e+06 |           0.5 | 1.910579176
  930 |    -9.3432411985e-06 |    -1.3397844588e+06 |             1 | 1.910579176
  940 |    -9.7118349909e-06 |    -1.3398125184e+06 |             1 | 1.910579176
  950 |    -7.2412983351e-06 |    -1.3398294328e+06 |             2 | 1.910579176
  960 |    -1.7329243134e-05 |    -1.3398711586e+06 |           0.5 | 1.910579176
  970 |    -1.3348547563e-05 |    -1.3399039132e+06 |             4 | 1.910579176
  980 |    -8.9435684909e-06 |    -1.3399305157e+06 |             4 | 1.910579176
  990 |    -1.0874284860e-05 |    -1.3399558954e+06 |             1 | 1.910579176

 iter |          tol         |        FLasso        |      Lf       |  lambda
--------------------------------------------------------------------------------
 1000 |    -7.0362841249e-06 |    -1.3399788715e+06 |             1 | 1.910579176
 1000 |     7.0362841249e-06 |    -1.3399788715e+06 |             1 | 1.910579176


FISTA: did not converge after 1000 iterations
FISTA: Relative error: 7.036284125e-06

Time for MC simulations: 12.4466975 seconds
Time for FISTA solver: 303.3264108 seconds


MATLAB result :
FISTA: converged in 1000 iterations (nnz(x)= 2984)
FISTA: Relative error: -1.34e-05
FISTA: Final Lf value: -1.337219e+06
Elapsed time is 7952.558757 seconds.

Amount wrong : 3731 / 263168 ~= 1.417725559%
0.1497808137 relative norm error.