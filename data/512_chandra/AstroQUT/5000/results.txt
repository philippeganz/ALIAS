WS test with 512x512 Chandra data.
Computing beta0...
beta0 = 1.219881e-09
Computing standardization and regularization values...
Computing standardization matrix...
100/100
Computing lambda and lambdaI...
100/100
lambda = 1.858329e+00
lambdaI = 5.510055e+07

Computing static estimate...
************************************* FISTA ************************************
A: 262144x263168 matrix, u: 262144 vector, b: 262144 vector
lambda:1.85833, tol:1e-10
********************************************************************************

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
   20 |    -8.5785935354e-03 |    -1.3073505220e+06 |             4 |    11773
   40 |    -1.1293382088e-03 |    -1.3177459904e+06 |             4 |     9389
   60 |    -6.9532409408e-04 |    -1.3219201446e+06 |             1 |     7004
   80 |    -4.3170855018e-04 |    -1.3240926595e+06 |             1 |     5698
  100 |    -2.7142488133e-04 |    -1.3254265107e+06 |             1 |     4959
  120 |    -1.9077202011e-04 |    -1.3263505481e+06 |             1 |     4440
  140 |    -1.4935079585e-04 |    -1.3270612983e+06 |             1 |     4080
  160 |    -1.2250150783e-04 |    -1.3276425262e+06 |             1 |     3823
  180 |    -1.0278964949e-04 |    -1.3281312437e+06 |             1 |     3622
  200 |    -6.9462353709e-05 |    -1.3284637204e+06 |             1 |     3482
  220 |    -6.0838958336e-05 |    -1.3287427842e+06 |             2 |     3370
  240 |    -5.4869202772e-05 |    -1.3289918459e+06 |             2 |     3254
  260 |    -4.9258295399e-05 |    -1.3292146717e+06 |             2 |     3154
  280 |    -4.5817289906e-05 |    -1.3294261166e+06 |             4 |     3082
  300 |    -3.8427952457e-05 |    -1.3296167981e+06 |             1 |     2982
  320 |    -4.8693605405e-05 |    -1.3298057271e+06 |             1 |     2887
  340 |    -3.6065838557e-05 |    -1.3299908405e+06 |             1 |     2804
  360 |    -4.6489577040e-05 |    -1.3301923860e+06 |             2 |     2721
  380 |    -4.6399188556e-05 |    -1.3303766674e+06 |             4 |     2635
  400 |    -2.7016013592e-05 |    -1.3305050622e+06 |             1 |     2636
  420 |    -1.7715667390e-05 |    -1.3306403350e+06 |             4 |     2550
  440 |    -2.9391612061e-05 |    -1.3307691086e+06 |             1 |     2496
  460 |    -2.2949713412e-05 |    -1.3308755503e+06 |            16 |     2490
  480 |    -1.8124317792e-05 |    -1.3309787922e+06 |             4 |     2426
  500 |    -1.5327170292e-05 |    -1.3310791828e+06 |             1 |     2389
  520 |    -1.7859623971e-05 |    -1.3312417973e+06 |             8 |     2353
  540 |    -1.3402810054e-05 |    -1.3313170021e+06 |            16 |     2330
  560 |    -1.0796900468e-05 |    -1.3313901584e+06 |             4 |     2268
  580 |    -1.9850803056e-05 |    -1.3314727492e+06 |             1 |     2226
  600 |    -1.0421072355e-05 |    -1.3315290247e+06 |             1 |     2210
  620 |    -1.4543504588e-05 |    -1.3316681833e+06 |             4 |     2174
  640 |    -1.7002585910e-05 |    -1.3317590702e+06 |            16 |     2171
  660 |    -1.5830513667e-05 |    -1.3318433499e+06 |             1 |     2084
  680 |    -1.5509603776e-05 |    -1.3319320021e+06 |             2 |     2044
  700 |    -8.2120858485e-06 |    -1.3320093493e+06 |             1 |     1995
  720 |    -1.4891728551e-05 |    -1.3320658629e+06 |             1 |     1977
  740 |    -1.9776587897e-05 |    -1.3321667061e+06 |             8 |     1979
  760 |    -7.3855339426e-06 |    -1.3322096134e+06 |             4 |     1942
  780 |    -1.1447097176e-05 |    -1.3322870153e+06 |             2 |     1876
  800 |    -2.1379189268e-05 |    -1.3323561393e+06 |             1 |     1880
  820 |    -1.4212823840e-05 |    -1.3324238333e+06 |             4 |     1861
  840 |    -1.4160408290e-05 |    -1.3324922755e+06 |             4 |     1858
  860 |    -8.3545522130e-06 |    -1.3325345154e+06 |             4 |     1812
  880 |    -7.4250958099e-06 |    -1.3325814854e+06 |             4 |     1822
  900 |    -1.9484827291e-05 |    -1.3326461736e+06 |             1 |     1751
  920 |    -1.1178739456e-05 |    -1.3327228554e+06 |             8 |     1784
  940 |    -1.3750628212e-05 |    -1.3327911723e+06 |             8 |     1774
  960 |    -1.0206584760e-05 |    -1.3328307852e+06 |             1 |     1691
  980 |    -1.5601418710e-05 |    -1.3329151329e+06 |             2 |     1697

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
 1000 |    -1.5542480444e-05 |    -1.3329812911e+06 |             1 |     1634
 1000 |     1.5542480444e-05 |    -1.3329812911e+06 |             1 |     1634


FISTA: did not converge after 1000 iterations
FISTA: Relative error: 1.554248044e-05

Getting non zero elements...
Generating non zero elements operator...
100/100
Generating the new beta estimates...
************************************* FISTA ************************************
A: 262144x1634 matrix, u: 262144 vector, b: 262144 vector
lambda:0, tol:1e-10
********************************************************************************

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
   20 |    -1.0542056263e-03 |    -1.3672061918e+06 |             4 |     1633
   40 |    -4.1326433980e-04 |    -1.3699308644e+06 |             2 |     1631
   60 |    -2.6798920281e-04 |    -1.3715301253e+06 |             4 |     1630
   80 |    -2.0416558270e-04 |    -1.3726012389e+06 |             1 |     1629
  100 |    -1.2786486361e-04 |    -1.3733462396e+06 |             1 |     1633
  120 |    -1.1550465904e-04 |    -1.3740067491e+06 |             1 |     1629
  140 |    -8.5450597638e-05 |    -1.3744729328e+06 |             2 |     1631
  160 |    -7.1964165782e-05 |    -1.3748564827e+06 |             1 |     1627
  180 |    -5.9501404332e-05 |    -1.3751882110e+06 |             4 |     1631
  200 |    -4.7267660828e-05 |    -1.3754567242e+06 |             1 |     1628
  220 |    -3.9079878018e-05 |    -1.3756725239e+06 |             2 |     1631
  240 |    -4.1564354396e-05 |    -1.3758773129e+06 |             1 |     1625
  260 |    -3.5454948577e-05 |    -1.3760681610e+06 |             1 |     1624
  280 |    -3.1944097899e-05 |    -1.3762341784e+06 |             4 |     1627
  300 |    -2.5434559580e-05 |    -1.3763803791e+06 |             1 |     1625
  320 |    -2.8211988043e-05 |    -1.3765374236e+06 |             1 |     1623
  340 |    -2.3488466674e-05 |    -1.3766564025e+06 |             1 |     1623
  360 |    -2.1554815858e-05 |    -1.3767654454e+06 |             1 |     1623
  380 |    -2.0214539325e-05 |    -1.3768720949e+06 |             1 |     1623
  400 |    -1.9826482757e-05 |    -1.3769729537e+06 |             1 |     1624
  420 |    -1.9072301933e-05 |    -1.3770632376e+06 |             1 |     1623
  440 |    -1.5317711271e-05 |    -1.3771465843e+06 |             2 |     1623
  460 |    -1.6071851977e-05 |    -1.3772257354e+06 |             4 |     1624
  480 |    -1.4016668644e-05 |    -1.3772931277e+06 |             4 |     1622
  500 |    -1.3629670389e-05 |    -1.3773625428e+06 |             1 |     1620
  520 |    -1.2260724256e-05 |    -1.3774189134e+06 |             4 |     1620
  540 |    -1.2035895602e-05 |    -1.3774800673e+06 |             1 |     1619
  560 |    -1.1679768009e-05 |    -1.3775354184e+06 |             1 |     1620
  580 |    -9.8611911299e-06 |    -1.3775855945e+06 |             2 |     1620
  600 |    -8.1573449704e-06 |    -1.3776349553e+06 |             1 |     1617
  620 |    -8.2635275753e-06 |    -1.3776840331e+06 |             2 |     1614
  640 |    -8.8193739119e-06 |    -1.3777265773e+06 |             2 |     1616
  660 |    -8.5362270176e-06 |    -1.3777685532e+06 |             4 |     1614
  680 |    -8.2038899782e-06 |    -1.3778100496e+06 |             1 |     1614
  700 |    -7.2338005782e-06 |    -1.3778489359e+06 |             1 |     1613
  720 |    -7.0846800317e-06 |    -1.3778894734e+06 |             2 |     1613
  740 |    -5.7419926963e-06 |    -1.3779194059e+06 |             4 |     1612
  760 |    -6.6900124051e-06 |    -1.3779541204e+06 |             2 |     1612
  780 |    -6.9280136815e-06 |    -1.3779879152e+06 |             1 |     1611
  800 |    -5.8538285303e-06 |    -1.3780189274e+06 |             1 |     1609
  820 |    -5.2757638637e-06 |    -1.3780501190e+06 |             2 |     1608
  840 |    -4.6450113309e-06 |    -1.3780750346e+06 |             2 |     1608
  860 |    -5.5365455163e-06 |    -1.3781011965e+06 |             4 |     1608
  880 |    -5.7471869577e-06 |    -1.3781292551e+06 |             1 |     1607
  900 |    -5.2246002275e-06 |    -1.3781559839e+06 |             1 |     1606
  920 |    -4.3797853054e-06 |    -1.3781810972e+06 |             2 |     1604
  940 |    -4.0040910119e-06 |    -1.3782025440e+06 |             2 |     1604
  960 |    -4.4563044287e-06 |    -1.3782245968e+06 |             2 |     1604
  980 |    -3.9134323093e-06 |    -1.3782448974e+06 |             4 |     1601

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
 1000 |    -4.6337032021e-06 |    -1.3782688220e+06 |             1 |     1600
 1000 |     4.6337032021e-06 |    -1.3782688220e+06 |             1 |     1600


FISTA: did not converge after 1000 iterations
FISTA: Relative error: 4.633703202e-06
New beta0 = 6.7065264e-10
Computing standardization and regularization values...
Computing standardization matrix...
100/100
Computing lambda and lambdaI...
100/100
lambda = 1.8684667543e+00
lambdaI = 5.6930448601e+07

Computing static estimate...
************************************* FISTA ************************************
A: 262144x263168 matrix, u: 262144 vector, b: 262144 vector
lambda:1.868466754, tol:1e-10
********************************************************************************

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
   20 |    -5.1541833379e-03 |    -1.3197602579e+06 |             1 |     1602
   40 |    -7.8148289161e-04 |    -1.3249390570e+06 |             1 |     1597
   60 |    -3.4238779647e-04 |    -1.3269203048e+06 |             4 |     1597
   80 |    -1.9440853291e-04 |    -1.3280899871e+06 |             2 |     1588
  100 |    -1.4196885228e-04 |    -1.3288412850e+06 |             1 |     1585
  120 |    -1.0432152602e-04 |    -1.3293772711e+06 |             1 |     1582
  140 |    -7.4253056075e-05 |    -1.3297549404e+06 |             1 |     1581
  160 |    -5.5658442849e-05 |    -1.3300442603e+06 |             4 |     1582
  180 |    -4.7915253430e-05 |    -1.3302775536e+06 |             1 |     1578
  200 |    -3.3961056707e-05 |    -1.3304595135e+06 |             1 |     1580
  220 |    -3.0543403113e-05 |    -1.3306323648e+06 |             2 |     1576
  240 |    -2.4002652319e-05 |    -1.3307633320e+06 |             2 |     1572
  260 |    -2.4724477289e-05 |    -1.3308870760e+06 |             1 |     1571
  280 |    -2.0719509617e-05 |    -1.3309907546e+06 |             2 |     1570
  300 |    -2.0913650339e-05 |    -1.3310885119e+06 |             1 |     1569
  320 |    -1.7719447700e-05 |    -1.3311748180e+06 |             2 |     1567
  340 |    -1.5014831015e-05 |    -1.3312548755e+06 |             2 |     1564
  360 |    -1.6548910992e-05 |    -1.3313358447e+06 |             1 |     1564
  380 |    -1.4650355128e-05 |    -1.3314079145e+06 |             2 |     1561
  400 |    -1.5565230999e-05 |    -1.3314795480e+06 |             1 |     1560
  420 |    -1.3786758103e-05 |    -1.3315457354e+06 |             2 |     1559
  440 |    -1.2055934943e-05 |    -1.3316093716e+06 |             2 |     1557
  460 |    -1.3099191241e-05 |    -1.3316741357e+06 |             1 |     1552
  480 |    -1.3220616817e-05 |    -1.3317358029e+06 |             1 |     1551
  500 |    -1.2350501913e-05 |    -1.3317949138e+06 |             1 |     1551
  520 |    -1.2755420926e-05 |    -1.3318589576e+06 |             1 |     1544
  540 |    -1.2075824978e-05 |    -1.3319159600e+06 |             4 |     1545
  560 |    -1.1203622943e-05 |    -1.3319717256e+06 |             2 |     1535
  580 |    -1.2386717541e-05 |    -1.3320282639e+06 |             1 |     1535
  600 |    -1.2417137694e-05 |    -1.3320827131e+06 |             1 |     1532
  620 |    -1.0648277323e-05 |    -1.3321361889e+06 |             2 |     1525
  640 |    -1.1804783026e-05 |    -1.3321958614e+06 |             1 |     1512
  660 |    -1.1825649042e-05 |    -1.3322531582e+06 |             2 |     1497
  680 |    -1.3880416806e-05 |    -1.3323138634e+06 |             2 |     1484
  700 |    -9.8474788706e-06 |    -1.3323684084e+06 |             1 |     1467
  720 |    -1.3546449124e-05 |    -1.3324334867e+06 |             1 |     1446
  740 |    -1.5632080813e-05 |    -1.3325072092e+06 |             1 |     1419
  760 |    -2.0013392983e-05 |    -1.3325784449e+06 |             4 |     1389
  780 |    -9.1013632612e-06 |    -1.3326224393e+06 |           0.5 |     1383
  800 |    -6.4921139295e-06 |    -1.3326616222e+06 |             1 |     1370
  820 |    -7.3595472628e-06 |    -1.3327003735e+06 |             2 |     1363
  840 |    -7.7759431583e-06 |    -1.3327325621e+06 |             2 |     1342
  860 |    -6.9366527357e-06 |    -1.3327652192e+06 |             4 |     1331
  880 |    -5.3212466677e-06 |    -1.3327979521e+06 |             1 |     1315
  900 |    -5.5293520522e-06 |    -1.3328329340e+06 |             1 |     1303
  920 |    -5.3494558822e-06 |    -1.3328645169e+06 |             1 |     1298
  940 |    -5.4127128973e-06 |    -1.3328986823e+06 |             2 |     1284
  960 |    -7.1251701468e-06 |    -1.3329321531e+06 |           0.5 |     1276
  980 |    -7.0107412527e-06 |    -1.3329628884e+06 |             1 |     1258

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
 1000 |    -6.1890400106e-06 |    -1.3329926809e+06 |             1 |     1253
 1000 |     6.1890400106e-06 |    -1.3329926809e+06 |             1 |     1253


FISTA: did not converge after 1000 iterations
FISTA: Relative error: 6.189040011e-06

Getting non zero elements...
Generating non zero elements operator...
100/100
Generating the new beta estimates...
************************************* FISTA ************************************
A: 262144x1253 matrix, u: 262144 vector, b: 262144 vector
lambda:0, tol:1e-10
********************************************************************************

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
   20 |    -1.0114670560e-03 |    -1.3672274447e+06 |             1 |     1253
   40 |    -4.5488389883e-04 |    -1.3701894776e+06 |             1 |     1253
   60 |    -2.2936706812e-04 |    -1.3716613973e+06 |             2 |     1253
   80 |    -1.4761556287e-04 |    -1.3725747527e+06 |             4 |     1252
  100 |    -1.0775694445e-04 |    -1.3732830379e+06 |             1 |     1251
  120 |    -9.8224881094e-05 |    -1.3738629696e+06 |             4 |     1253
  140 |    -7.4886362684e-05 |    -1.3742883879e+06 |             2 |     1251
  160 |    -6.5461149562e-05 |    -1.3746498862e+06 |             1 |     1253
  180 |    -5.4179400784e-05 |    -1.3749442769e+06 |             1 |     1253
  200 |    -4.3916833243e-05 |    -1.3751984261e+06 |             1 |     1253
  220 |    -4.5586970734e-05 |    -1.3754362490e+06 |             1 |     1253
  240 |    -3.7994070864e-05 |    -1.3756284543e+06 |             2 |     1253
  260 |    -3.1726467096e-05 |    -1.3757982421e+06 |             2 |     1253
  280 |    -2.7982415878e-05 |    -1.3759513502e+06 |             1 |     1253
  300 |    -2.4292194979e-05 |    -1.3760879936e+06 |             1 |     1253
  320 |    -2.5641800405e-05 |    -1.3762196018e+06 |             1 |     1253
  340 |    -2.4219474423e-05 |    -1.3763333864e+06 |           0.5 |     1253
  360 |    -2.1002600374e-05 |    -1.3764354497e+06 |             4 |     1253
  380 |    -1.7946744750e-05 |    -1.3765265803e+06 |             2 |     1253
  400 |    -1.7318524660e-05 |    -1.3766126217e+06 |             1 |     1253
  420 |    -1.6074359764e-05 |    -1.3766909049e+06 |             1 |     1253
  440 |    -1.3845909267e-05 |    -1.3767615934e+06 |             4 |     1253
  460 |    -1.2735965223e-05 |    -1.3768322780e+06 |             4 |     1253
  480 |    -1.2144915017e-05 |    -1.3768981151e+06 |             2 |     1253
  500 |    -1.0646898106e-05 |    -1.3769543140e+06 |             1 |     1253
  520 |    -1.1771550265e-05 |    -1.3770106735e+06 |             1 |     1253
  540 |    -1.0248643407e-05 |    -1.3770602688e+06 |             1 |     1253
  560 |    -8.9268186535e-06 |    -1.3771057652e+06 |             4 |     1253
  580 |    -8.6230272056e-06 |    -1.3771523482e+06 |             2 |     1252
  600 |    -8.8492533814e-06 |    -1.3771945269e+06 |             1 |     1253
  620 |    -7.9693551356e-06 |    -1.3772353371e+06 |             1 |     1253
  640 |    -8.1094671281e-06 |    -1.3772723689e+06 |           0.5 |     1253
  660 |    -7.3525525260e-06 |    -1.3773063394e+06 |             4 |     1253
  680 |    -5.2405946655e-06 |    -1.3773381001e+06 |             2 |     1252
  700 |    -5.5695524997e-06 |    -1.3773706444e+06 |             1 |     1252
  720 |    -5.6790945780e-06 |    -1.3774010399e+06 |             2 |     1252
  740 |    -5.5180803052e-06 |    -1.3774303689e+06 |             2 |     1250
  760 |    -4.5444545168e-06 |    -1.3774570279e+06 |             1 |     1252
  780 |    -4.4433952974e-06 |    -1.3774817453e+06 |             4 |     1251
  800 |    -4.7749587534e-06 |    -1.3775072775e+06 |             1 |     1251
  820 |    -5.2269782880e-06 |    -1.3775328522e+06 |           0.5 |     1251
  840 |    -3.8771977153e-06 |    -1.3775547184e+06 |             4 |     1251
  860 |    -4.0049620653e-06 |    -1.3775757717e+06 |             2 |     1251
  880 |    -3.3570195983e-06 |    -1.3775942591e+06 |             1 |     1249
  900 |    -4.3951016316e-06 |    -1.3776163380e+06 |             1 |     1250
  920 |    -3.9714554665e-06 |    -1.3776349481e+06 |             4 |     1247
  940 |    -3.3463434440e-06 |    -1.3776529267e+06 |             2 |     1250
  960 |    -3.8552562718e-06 |    -1.3776727978e+06 |             2 |     1245
  980 |    -3.5838115161e-06 |    -1.3776898136e+06 |           0.5 |     1249

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
 1000 |    -2.9297601828e-06 |    -1.3777063710e+06 |             1 |     1249
 1000 |     2.9297601828e-06 |    -1.3777063710e+06 |             1 |     1249


FISTA: did not converge after 1000 iterations
FISTA: Relative error: 2.929760183e-06
New beta0 = 5.948767563e-10

Time for MC simulations: 646.3261101 seconds
Time for FISTA solver: 391.7775971 seconds
Time for GLM fit on non zero elements: 759.6026182 seconds
Time for MC simulations 2: 669.7177615 seconds
Time for FISTA solver 2: 365.9981882 seconds
Time for GLM fit on non zero elements 2: 583.1774336 seconds
Total time: 3416.599709 seconds


MATLAB result :
FISTA: did not converge in 1000 iterations (nnz(x)= 2329)
FISTA: Relative error: -1.93e-06
FISTA: Final FLasso value: -1.387380e+06
Elapsed time is 9293.529344 seconds.

Amount wrong : 1947 / 263168 ~= 0.7398315905%
nan relative norm error.