WS test with 512x512 Chandra data.
Computing beta0...
beta0 = 1.219881e-09
Computing standardization and regularization values with 5000 MC simulations...
Computing standardization matrix...
100/100
Computing lambda and lambdaI...
100/100
lambda = 1.849763e+00
lambdaI = 5.397112e+07

Computing static estimate...
************************************* FISTA ************************************
A: 262144x263168 matrix, u: 262144 vector, b: 262144 vector
lambda:1.84976, tol:1e-10
********************************************************************************

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
   20 |    -8.4094348712e-03 |    -1.3077570230e+06 |             4 |    12181
   40 |    -1.0879890857e-03 |    -1.3184570298e+06 |             8 |     9804
   60 |    -4.5350306588e-04 |    -1.3210479300e+06 |             8 |     8281
   80 |    -3.6447532203e-04 |    -1.3227560841e+06 |            16 |     7316
  100 |    -2.3877272818e-04 |    -1.3240429507e+06 |             1 |     6395
  120 |    -1.9724072287e-04 |    -1.3249902065e+06 |             8 |     5847
  140 |    -1.4096971465e-04 |    -1.3256789475e+06 |             8 |     5386
  160 |    -1.0261954747e-04 |    -1.3262487806e+06 |            16 |     5139
  180 |    -9.3165486017e-05 |    -1.3267330360e+06 |             4 |     4798
  200 |    -7.1635436296e-05 |    -1.3271069718e+06 |             1 |     4638
  220 |    -7.9536251458e-05 |    -1.3276446906e+06 |             8 |     4303
  240 |    -7.8070399662e-05 |    -1.3279407228e+06 |             2 |     4170
  260 |    -5.6708205648e-05 |    -1.3282152041e+06 |            16 |     4053
  280 |    -1.0244363250e-04 |    -1.3286335159e+06 |            16 |     3846
  300 |    -6.1812305908e-05 |    -1.3290158404e+06 |             1 |     3685
  320 |    -4.3160326609e-05 |    -1.3293449589e+06 |             8 |     3531
  340 |    -4.7178622415e-05 |    -1.3296121968e+06 |             4 |     3451
  360 |    -3.7641170158e-05 |    -1.3298478228e+06 |             2 |     3313
  380 |    -3.5582066732e-05 |    -1.3300276754e+06 |             8 |     3209
  400 |    -2.1088888524e-05 |    -1.3301723638e+06 |             1 |     3187
  420 |    -2.7213663751e-05 |    -1.3303356343e+06 |             8 |     3041
  440 |    -3.1996106031e-05 |    -1.3305004094e+06 |             8 |     2994
  460 |    -3.2180223183e-05 |    -1.3306192541e+06 |             1 |     2892
  480 |    -2.1315204207e-05 |    -1.3307229601e+06 |             4 |     2885
  500 |    -2.5028106353e-05 |    -1.3308303301e+06 |             1 |     2837
  520 |    -3.1515866250e-05 |    -1.3309636498e+06 |             1 |     2730
  540 |    -2.4027477079e-05 |    -1.3310673714e+06 |             4 |     2729
  560 |    -1.6994511790e-05 |    -1.3311560467e+06 |             8 |     2648
  580 |    -2.2242092208e-05 |    -1.3312319632e+06 |            16 |     2684
  600 |    -2.1502949385e-05 |    -1.3313264110e+06 |             1 |     2585
  620 |    -1.1958862952e-05 |    -1.3313907769e+06 |             4 |     2586
  640 |    -1.2232757028e-05 |    -1.3314660640e+06 |             4 |     2532
  660 |    -1.9593785330e-05 |    -1.3315377304e+06 |             8 |     2555
  680 |    -1.9800930748e-05 |    -1.3316231805e+06 |             4 |     2501
  700 |    -1.5571563487e-05 |    -1.3317077185e+06 |             1 |     2489
  720 |    -1.1262865947e-05 |    -1.3317833793e+06 |             4 |     2420
  740 |    -1.0125579639e-05 |    -1.3318324891e+06 |             4 |     2404
  760 |    -1.8351042662e-05 |    -1.3318975700e+06 |             4 |     2432
  780 |    -1.5405541312e-05 |    -1.3319781670e+06 |             8 |     2393
  800 |    -1.1320044674e-05 |    -1.3320412192e+06 |             1 |     2306
  820 |    -2.1442519882e-05 |    -1.3321558687e+06 |             8 |     2253
  840 |    -1.6605066778e-05 |    -1.3322764874e+06 |             1 |     2204
  860 |    -1.0646839763e-05 |    -1.3323567775e+06 |             4 |     2202
  880 |    -2.3243760959e-05 |    -1.3324581879e+06 |            16 |     2210
  900 |    -1.1829517735e-05 |    -1.3325332713e+06 |             1 |     2093
  920 |    -1.7530084648e-05 |    -1.3326192656e+06 |            16 |     2147
  940 |    -2.7187370521e-05 |    -1.3327147631e+06 |           0.5 |     2020
  960 |    -2.5969522963e-05 |    -1.3328006290e+06 |           0.5 |     1967
  980 |    -1.9873371647e-05 |    -1.3328791657e+06 |             8 |     2009

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
 1000 |    -2.4251008787e-05 |    -1.3329746017e+06 |             1 |     1897
 1000 |     2.4251008787e-05 |    -1.3329746017e+06 |             1 |     1897


FISTA: did not converge after 1000 iterations
FISTA: Relative error: 2.425100879e-05

Getting non zero elements...
Generating non zero elements operator...
100/100
Generating the new beta estimates...
************************************* FISTA ************************************
A: 262144x1897 matrix, u: 262144 vector, b: 262144 vector
lambda:0, tol:1e-10
********************************************************************************

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
   20 |    -9.2312715253e-04 |    -1.3694016833e+06 |             2 |     1897
   40 |    -3.2770638456e-04 |    -1.3720032146e+06 |             4 |     1897
   60 |    -2.5780032554e-04 |    -1.3736563057e+06 |             2 |     1896
   80 |    -1.9957156324e-04 |    -1.3747730022e+06 |             2 |     1894
  100 |    -1.3758176946e-04 |    -1.3756190258e+06 |             1 |     1894
  120 |    -1.0265543767e-04 |    -1.3762315769e+06 |             2 |     1894
  140 |    -7.9336456532e-05 |    -1.3766996556e+06 |             2 |     1892
  160 |    -4.7198595260e-05 |    -1.3770235882e+06 |             2 |     1889
  180 |    -5.1256596749e-05 |    -1.3772895437e+06 |             2 |     1894
  200 |    -4.3492889441e-05 |    -1.3775156042e+06 |             1 |     1894
  220 |    -3.6885886865e-05 |    -1.3777401426e+06 |             2 |     1894
  240 |    -2.9487174018e-05 |    -1.3779179994e+06 |             2 |     1894
  260 |    -3.1332278583e-05 |    -1.3780633036e+06 |             2 |     1894
  280 |    -2.2064141409e-05 |    -1.3781927507e+06 |             2 |     1891
  300 |    -2.3479493936e-05 |    -1.3783123116e+06 |             1 |     1893
  320 |    -2.3329690985e-05 |    -1.3784395751e+06 |             1 |     1890
  340 |    -2.1247218952e-05 |    -1.3785536880e+06 |             1 |     1890
  360 |    -1.9074014601e-05 |    -1.3786517694e+06 |             1 |     1890
  380 |    -1.7723676341e-05 |    -1.3787462686e+06 |             1 |     1893
  400 |    -1.6146222424e-05 |    -1.3788286076e+06 |             1 |     1889
  420 |    -1.5043095207e-05 |    -1.3789089096e+06 |             1 |     1892
  440 |    -1.4001252191e-05 |    -1.3789748365e+06 |             1 |     1892
  460 |    -1.2211951599e-05 |    -1.3790413899e+06 |             1 |     1888
  480 |    -1.2233008237e-05 |    -1.3791073473e+06 |             1 |     1891
  500 |    -1.1602663007e-05 |    -1.3791694186e+06 |             1 |     1890
  520 |    -1.1027088125e-05 |    -1.3792250647e+06 |             1 |     1893
  540 |    -9.8944141302e-06 |    -1.3792750949e+06 |             1 |     1889
  560 |    -8.2719983847e-06 |    -1.3793153967e+06 |             2 |     1885
  580 |    -9.3029158425e-06 |    -1.3793623785e+06 |             4 |     1889
  600 |    -8.1364094967e-06 |    -1.3794068262e+06 |             1 |     1888
  620 |    -7.7678968585e-06 |    -1.3794477877e+06 |             1 |     1886
  640 |    -8.2131791774e-06 |    -1.3794892638e+06 |             1 |     1885
  660 |    -7.3331695641e-06 |    -1.3795271793e+06 |             1 |     1885
  680 |    -4.3688874990e-06 |    -1.3795593564e+06 |             2 |     1882
  700 |    -6.8958270931e-06 |    -1.3795979623e+06 |             1 |     1878
  720 |    -7.1182356432e-06 |    -1.3796338155e+06 |             1 |     1878
  740 |    -6.1635667112e-06 |    -1.3796658317e+06 |             1 |     1875
  760 |    -6.9235593115e-06 |    -1.3796962123e+06 |             1 |     1874
  780 |    -5.8070111901e-06 |    -1.3797263246e+06 |             1 |     1871
  800 |    -6.1880051152e-06 |    -1.3797574760e+06 |             1 |     1871
  820 |    -5.5580492795e-06 |    -1.3797861371e+06 |             1 |     1870
  840 |    -3.9422213925e-06 |    -1.3798116961e+06 |             1 |     1863
  860 |    -5.0797291264e-06 |    -1.3798397238e+06 |             1 |     1866
  880 |    -5.4201663352e-06 |    -1.3798670917e+06 |             1 |     1865
  900 |    -4.8616922669e-06 |    -1.3798923162e+06 |             1 |     1861
  920 |    -5.1981943261e-06 |    -1.3799185537e+06 |             1 |     1860
  940 |    -4.6719642748e-06 |    -1.3799427937e+06 |             1 |     1856
  960 |    -5.0026350624e-06 |    -1.3799680567e+06 |             1 |     1853
  980 |    -4.5011411030e-06 |    -1.3799914352e+06 |             1 |     1851

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
 1000 |    -4.8310471799e-06 |    -1.3800158613e+06 |             1 |     1848
 1000 |     4.8310471799e-06 |    -1.3800158613e+06 |             1 |     1848


FISTA: did not converge after 1000 iterations
FISTA: Relative error: 4.83104718e-06
New beta0 = 7.408135583e-10
Computing standardization and regularization values with 5000 MC simulations...
Computing standardization matrix...
100/100
Computing lambda and lambdaI...
100/100
lambda = 1.8765022152e+00
lambdaI = 5.4765062413e+07

Computing static estimate...
************************************* FISTA ************************************
A: 262144x263168 matrix, u: 262144 vector, b: 262144 vector
lambda:1.876502215, tol:1e-10
********************************************************************************

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
   20 |    -5.1786137373e-03 |    -1.3207606823e+06 |             1 |     1846
   40 |    -7.6947720975e-04 |    -1.3259110512e+06 |             1 |     1846
   60 |    -3.6423709169e-04 |    -1.3279344402e+06 |             1 |     1848
   80 |    -1.9623023459e-04 |    -1.3290080422e+06 |             4 |     1849
  100 |    -1.2397248288e-04 |    -1.3297224143e+06 |             1 |     1848
  120 |    -8.2973582851e-05 |    -1.3302557487e+06 |             4 |     1843
  140 |    -6.9949897356e-05 |    -1.3306258803e+06 |             1 |     1841
  160 |    -5.1464252829e-05 |    -1.3308945847e+06 |             2 |     1841
  180 |    -4.4093532277e-05 |    -1.3311184798e+06 |             2 |     1838
  200 |    -3.5296362572e-05 |    -1.3312960819e+06 |             1 |     1838
  220 |    -2.7457723155e-05 |    -1.3314466626e+06 |             2 |     1836
  240 |    -2.7957974926e-05 |    -1.3315870449e+06 |             1 |     1835
  260 |    -2.3985122344e-05 |    -1.3317034734e+06 |             4 |     1837
  280 |    -2.3275877962e-05 |    -1.3318125937e+06 |             1 |     1833
  300 |    -2.0491438830e-05 |    -1.3319086136e+06 |             1 |     1830
  320 |    -1.7021072920e-05 |    -1.3319967287e+06 |             4 |     1830
  340 |    -1.4958557599e-05 |    -1.3320807374e+06 |             2 |     1828
  360 |    -1.7370614539e-05 |    -1.3321654177e+06 |             1 |     1827
  380 |    -1.5775231065e-05 |    -1.3322408612e+06 |             4 |     1829
  400 |    -1.4355926396e-05 |    -1.3323124901e+06 |             1 |     1823
  420 |    -1.4672298771e-05 |    -1.3323883470e+06 |             1 |     1821
  440 |    -1.3924251038e-05 |    -1.3324544293e+06 |             4 |     1822
  460 |    -1.3196857878e-05 |    -1.3325188113e+06 |             2 |     1809
  480 |    -1.4076144110e-05 |    -1.3325840015e+06 |             1 |     1804
  500 |    -1.4076246787e-05 |    -1.3326465141e+06 |             1 |     1798
  520 |    -1.2603631613e-05 |    -1.3327075508e+06 |             4 |     1789
  540 |    -1.2457910088e-05 |    -1.3327670962e+06 |             4 |     1768
  560 |    -1.0644227442e-05 |    -1.3328259053e+06 |             2 |     1736
  580 |    -1.3927590312e-05 |    -1.3328902712e+06 |             1 |     1715
  600 |    -1.4296234958e-05 |    -1.3329558710e+06 |             1 |     1694
  620 |    -1.5096526779e-05 |    -1.3330235998e+06 |             2 |     1670
  640 |    -1.1515411222e-05 |    -1.3330796935e+06 |             1 |     1639
  660 |    -1.9404112956e-05 |    -1.3331487289e+06 |           0.5 |     1611
  680 |    -1.9071333807e-05 |    -1.3332188873e+06 |           0.5 |     1598
  700 |    -1.9117079961e-05 |    -1.3332904591e+06 |             1 |     1579
  720 |    -1.2801257357e-05 |    -1.3333485987e+06 |             2 |     1565
  740 |    -8.8532121874e-06 |    -1.3333982710e+06 |             2 |     1555
  760 |    -9.8421200752e-06 |    -1.3334407836e+06 |             2 |     1523
  780 |    -9.6507807580e-06 |    -1.3334825032e+06 |           0.5 |     1502
  800 |    -7.4828918295e-06 |    -1.3335224166e+06 |             1 |     1478
  820 |    -5.9693431544e-06 |    -1.3335601744e+06 |             2 |     1467
  840 |    -6.9978102064e-06 |    -1.3335939404e+06 |             2 |     1459
  860 |    -6.8628585889e-06 |    -1.3336241805e+06 |           0.5 |     1441
  880 |    -5.2309762250e-06 |    -1.3336513064e+06 |             2 |     1432
  900 |    -6.2936822258e-06 |    -1.3336824512e+06 |             1 |     1415
  920 |    -7.1485281571e-06 |    -1.3337128391e+06 |           0.5 |     1407
  940 |    -1.2127585846e-05 |    -1.3337549624e+06 |             2 |     1414
  960 |    -7.1641111892e-06 |    -1.3337894316e+06 |             2 |     1402
  980 |    -7.2677279059e-06 |    -1.3338223158e+06 |             2 |     1373

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
 1000 |    -3.6752958252e-06 |    -1.3338470834e+06 |             1 |     1354
 1000 |     3.6752958252e-06 |    -1.3338470834e+06 |             1 |     1354


FISTA: did not converge after 1000 iterations
FISTA: Relative error: 3.675295825e-06

Getting non zero elements...
Generating non zero elements operator...
100/100
Generating the new beta estimates...
************************************* FISTA ************************************
A: 262144x1354 matrix, u: 262144 vector, b: 262144 vector
lambda:0, tol:1e-10
********************************************************************************

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
   20 |    -1.2822531891e-03 |    -1.3688577600e+06 |           0.5 |     1348
   40 |    -5.0720139017e-04 |    -1.3719920024e+06 |             1 |     1353
   60 |    -3.0175669250e-04 |    -1.3737494912e+06 |           0.5 |     1349
   80 |    -2.1812638506e-04 |    -1.3748612638e+06 |           0.5 |     1350
  100 |    -1.5397833954e-04 |    -1.3756246132e+06 |             1 |     1349
  120 |    -1.2161110347e-04 |    -1.3761988627e+06 |           0.5 |     1349
  140 |    -9.1315900230e-05 |    -1.3766546241e+06 |           0.5 |     1348
  160 |    -7.5150751321e-05 |    -1.3770113593e+06 |           0.5 |     1350
  180 |    -6.4213530895e-05 |    -1.3773149158e+06 |           0.5 |     1349
  200 |    -5.3991482967e-05 |    -1.3775685674e+06 |             1 |     1348
  220 |    -4.6162806416e-05 |    -1.3777840617e+06 |           0.5 |     1349
  240 |    -4.0065603503e-05 |    -1.3779695869e+06 |           0.5 |     1348
  260 |    -2.1183847698e-05 |    -1.3781010726e+06 |             2 |     1351
  280 |    -1.9058633146e-05 |    -1.3782201427e+06 |             2 |     1351
  300 |    -1.7248550825e-05 |    -1.3783276329e+06 |             1 |     1351
  320 |    -2.1197401780e-05 |    -1.3784521084e+06 |             2 |     1350
  340 |    -1.8842157369e-05 |    -1.3785572282e+06 |             2 |     1350
  360 |    -1.6786556433e-05 |    -1.3786516166e+06 |             2 |     1350
  380 |    -1.4940499978e-05 |    -1.3787366137e+06 |             4 |     1348
  400 |    -1.3083657756e-05 |    -1.3788004329e+06 |             1 |     1345
  420 |    -1.2108625156e-05 |    -1.3788588001e+06 |             2 |     1345
  440 |    -1.0523483317e-05 |    -1.3789143964e+06 |             1 |     1346
  460 |    -9.2887151324e-06 |    -1.3789637178e+06 |             2 |     1345
  480 |    -8.0383186423e-06 |    -1.3790105179e+06 |             2 |     1348
  500 |    -1.0628571769e-05 |    -1.3790600259e+06 |             1 |     1345
  520 |    -8.5384905349e-06 |    -1.3791010374e+06 |             2 |     1345
  540 |    -6.5928378358e-06 |    -1.3791393272e+06 |             2 |     1348
  560 |    -8.7694639698e-06 |    -1.3791800891e+06 |           0.5 |     1345
  580 |    -7.0882068608e-06 |    -1.3792140845e+06 |             2 |     1345
  600 |    -5.5091174139e-06 |    -1.3792460177e+06 |             1 |     1348
  620 |    -6.7092101806e-06 |    -1.3792852166e+06 |             2 |     1348
  640 |    -6.3690941136e-06 |    -1.3793202917e+06 |             2 |     1345
  660 |    -4.9410694649e-06 |    -1.3793470335e+06 |             2 |     1345
  680 |    -4.3706512881e-06 |    -1.3793723145e+06 |             2 |     1348
  700 |    -5.9010683217e-06 |    -1.3793996085e+06 |             1 |     1345
  720 |    -5.0426145868e-06 |    -1.3794227038e+06 |             2 |     1345
  740 |    -4.6235124356e-06 |    -1.3794447836e+06 |             2 |     1345
  760 |    -3.6390946216e-06 |    -1.3794658015e+06 |             2 |     1348
  780 |    -3.3307630388e-06 |    -1.3794861472e+06 |             2 |     1348
  800 |    -4.7569571797e-06 |    -1.3795080944e+06 |             1 |     1345
  820 |    -3.9273416360e-06 |    -1.3795267973e+06 |             2 |     1345
  840 |    -3.7812345786e-06 |    -1.3795448312e+06 |             2 |     1345
  860 |    -2.9950969896e-06 |    -1.3795620981e+06 |             2 |     1348
  880 |    -2.8983653977e-06 |    -1.3795789243e+06 |             2 |     1348
  900 |    -3.9728560271e-06 |    -1.3795972063e+06 |             1 |     1345
  920 |    -3.8461366858e-06 |    -1.3796128962e+06 |           0.5 |     1345
  940 |    -3.3344282040e-06 |    -1.3796281082e+06 |             2 |     1344
  960 |    -3.4960496538e-06 |    -1.3796428855e+06 |           0.5 |     1343
  980 |    -3.0189651022e-06 |    -1.3796572229e+06 |             2 |     1342

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
 1000 |    -2.9341864016e-06 |    -1.3796711761e+06 |             1 |     1340
 1000 |     2.9341864016e-06 |    -1.3796711761e+06 |             1 |     1340


FISTA: did not converge after 1000 iterations
FISTA: Relative error: 2.934186402e-06
New beta0 = 6.146723062e-10

Time for MC simulations: 587.943892 seconds
Time for FISTA solver: 301.4235334 seconds
Time for GLM fit on non zero elements: 736.4799723 seconds
Time for MC simulations 2: 583.332218 seconds
Time for FISTA solver 2: 312.9427523 seconds
Time for GLM fit on non zero elements 2: 534.184548 seconds
Total time: 3056.306916 seconds


MATLAB result :
FISTA: did not converge in 1000 iterations (nnz(x)= 2329)
FISTA: Relative error: -1.93e-06
FISTA: Final FLasso value: -1.387380e+06
Elapsed time is 9293.529344 seconds.

Amount wrong : 2368 / 263168 ~= 0.8998054475%
0.4164079645 relative norm error.