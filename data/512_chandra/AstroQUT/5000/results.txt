WS test with 512x512 Chandra data.
Computing beta0...
beta0 = 1.219881e-09
Computing standardization and regularization values...
Computing standardization matrix...
100/100
Computing lambda and lambdaI...
100/100
lambda = 1.867541e+00
lambdaI = 5.542332e+07

Computing static estimate...
************************************* FISTA ************************************
A: 262144x263168 matrix, u: 262144 vector, b: 262144 vector
lambda:1.86754, tol:1e-10
********************************************************************************

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
   20 |    -9.2787684925e-03 |    -1.3080728029e+06 |             8 |    11698
   40 |    -1.0982577713e-03 |    -1.3182033986e+06 |             8 |     9008
   60 |    -5.2491568437e-04 |    -1.3211118513e+06 |             2 |     7240
   80 |    -3.0931522552e-04 |    -1.3227231454e+06 |             2 |     6322
  100 |    -2.2809526057e-04 |    -1.3238723021e+06 |             1 |     5595
  120 |    -1.8653486402e-04 |    -1.3247332885e+06 |             2 |     5170
  140 |    -1.5257269897e-04 |    -1.3254369682e+06 |             2 |     4774
  160 |    -9.0625152340e-05 |    -1.3259407226e+06 |             4 |     4507
  180 |    -6.2624944159e-05 |    -1.3263623209e+06 |             8 |     4305
  200 |    -7.2193814511e-05 |    -1.3267488839e+06 |             1 |     4131
  220 |    -7.0512985926e-05 |    -1.3270318622e+06 |             8 |     3962
  240 |    -6.1406085772e-05 |    -1.3272926547e+06 |             8 |     3880
  260 |    -5.8005040791e-05 |    -1.3275877299e+06 |            16 |     3740
  280 |    -4.4641096943e-05 |    -1.3278405924e+06 |             8 |     3632
  300 |    -4.5114153574e-05 |    -1.3280937756e+06 |             1 |     3538
  320 |    -4.5285352195e-05 |    -1.3283119393e+06 |             4 |     3438
  340 |    -3.5267624366e-05 |    -1.3285765693e+06 |             8 |     3285
  360 |    -3.9948684939e-05 |    -1.3288591625e+06 |             4 |     3197
  380 |    -4.7045898101e-05 |    -1.3291387809e+06 |             4 |     3070
  400 |    -2.2289030157e-05 |    -1.3292596079e+06 |             1 |     3045
  420 |    -2.8167861883e-05 |    -1.3294040044e+06 |             4 |     2933
  440 |    -3.1074557707e-05 |    -1.3295415884e+06 |             2 |     2868
  460 |    -2.3377542260e-05 |    -1.3296441819e+06 |             8 |     2875
  480 |    -3.0322023572e-05 |    -1.3297686432e+06 |             1 |     2761
  500 |    -2.1791109651e-05 |    -1.3298709640e+06 |             1 |     2743
  520 |    -1.7570111136e-05 |    -1.3299691688e+06 |             4 |     2699
  540 |    -2.3116175519e-05 |    -1.3300785489e+06 |             2 |     2667
  560 |    -2.0022465610e-05 |    -1.3301660843e+06 |            16 |     2656
  580 |    -1.6476381990e-05 |    -1.3302569248e+06 |             8 |     2597
  600 |    -1.7694503479e-05 |    -1.3303550474e+06 |             1 |     2528
  620 |    -1.2452028939e-05 |    -1.3304778210e+06 |            16 |     2523
  640 |    -1.8009125594e-05 |    -1.3305719875e+06 |             2 |     2459
  660 |    -2.0146012436e-05 |    -1.3306646343e+06 |             8 |     2415
  680 |    -2.1356814072e-05 |    -1.3307513698e+06 |            16 |     2431
  700 |    -2.0584846607e-05 |    -1.3308398526e+06 |             1 |     2361
  720 |    -1.8088640742e-05 |    -1.3309217464e+06 |            16 |     2321
  740 |    -1.3989650845e-05 |    -1.3310140817e+06 |             8 |     2320
  760 |    -1.5859884807e-05 |    -1.3310885422e+06 |             8 |     2289
  780 |    -1.0412061259e-05 |    -1.3311403034e+06 |             8 |     2271
  800 |    -1.0778857759e-05 |    -1.3312069968e+06 |             1 |     2246
  820 |    -1.9183817968e-05 |    -1.3312852007e+06 |             4 |     2161
  840 |    -1.5609694574e-05 |    -1.3313443734e+06 |             4 |     2170
  860 |    -9.9213508742e-06 |    -1.3313935769e+06 |             4 |     2113
  880 |    -1.5007378087e-05 |    -1.3314562655e+06 |             2 |     2140
  900 |    -1.5971092522e-05 |    -1.3315452302e+06 |             1 |     2104
  920 |    -1.3303858218e-05 |    -1.3316095840e+06 |             2 |     2050
  940 |    -1.2345466309e-05 |    -1.3316587493e+06 |             4 |     2056
  960 |    -1.1476346009e-05 |    -1.3317238807e+06 |             4 |     1997
  980 |    -9.9324355209e-06 |    -1.3317811464e+06 |             4 |     1977

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
 1000 |    -2.6472043068e-05 |    -1.3318815804e+06 |             1 |     1936
 1000 |     2.6472043068e-05 |    -1.3318815804e+06 |             1 |     1936


FISTA: did not converge after 1000 iterations
FISTA: Relative error: 2.647204307e-05

Getting non zero elements...
Generating non zero elements operator...
100/100
Generating the new beta estimates...
************************************* FISTA ************************************
A: 262144x1936 matrix, u: 262144 vector, b: 262144 vector
lambda:0, tol:1e-10
********************************************************************************

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
   20 |    -1.1289947738e-03 |    -1.3666191559e+06 |             1 |     1936
   40 |    -4.8586430807e-04 |    -1.3694517723e+06 |             1 |     1935
   60 |    -2.5233971717e-04 |    -1.3709563004e+06 |             2 |     1936
   80 |    -1.7548652239e-04 |    -1.3720025190e+06 |             2 |     1936
  100 |    -1.3077542088e-04 |    -1.3727610218e+06 |             1 |     1935
  120 |    -1.0077445692e-04 |    -1.3733945835e+06 |             2 |     1935
  140 |    -8.2316348199e-05 |    -1.3738591418e+06 |             4 |     1935
  160 |    -7.5306565266e-05 |    -1.3742498011e+06 |             2 |     1931
  180 |    -5.7904406799e-05 |    -1.3745636311e+06 |             2 |     1935
  200 |    -5.1116328462e-05 |    -1.3748447452e+06 |             1 |     1935
  220 |    -4.3640315553e-05 |    -1.3751094875e+06 |             2 |     1935
  240 |    -4.0363962444e-05 |    -1.3753238620e+06 |             2 |     1928
  260 |    -3.7520938392e-05 |    -1.3755125607e+06 |             2 |     1927
  280 |    -3.0671775820e-05 |    -1.3756743903e+06 |             2 |     1933
  300 |    -2.9881548199e-05 |    -1.3758282122e+06 |             1 |     1926
  320 |    -2.4721907935e-05 |    -1.3759609836e+06 |             2 |     1933
  340 |    -2.3027996547e-05 |    -1.3760867077e+06 |             4 |     1931
  360 |    -2.3497116027e-05 |    -1.3762036306e+06 |             1 |     1926
  380 |    -1.9435577553e-05 |    -1.3763053609e+06 |             2 |     1932
  400 |    -1.9442237016e-05 |    -1.3764046291e+06 |             1 |     1926
  420 |    -1.6403988341e-05 |    -1.3764921778e+06 |             2 |     1933
  440 |    -1.6409182386e-05 |    -1.3765777571e+06 |             2 |     1926
  460 |    -1.6239527785e-05 |    -1.3766572324e+06 |             1 |     1924
  480 |    -1.3586880734e-05 |    -1.3767283270e+06 |             4 |     1929
  500 |    -1.4131673294e-05 |    -1.3767989807e+06 |             1 |     1924
  520 |    -1.2022814942e-05 |    -1.3768621793e+06 |             2 |     1931
  540 |    -1.2262039458e-05 |    -1.3769250680e+06 |             2 |     1924
  560 |    -1.2299556546e-05 |    -1.3769842292e+06 |             1 |     1924
  580 |    -1.0397533922e-05 |    -1.3770378982e+06 |             4 |     1928
  600 |    -1.1030051828e-05 |    -1.3770921125e+06 |             1 |     1923
  620 |    -9.3860155180e-06 |    -1.3771410125e+06 |             4 |     1929
  640 |    -9.9727876371e-06 |    -1.3771905340e+06 |             2 |     1923
  660 |    -8.6441817310e-06 |    -1.3772354752e+06 |             4 |     1928
  680 |    -9.1872628210e-06 |    -1.3772810813e+06 |             2 |     1921
  700 |    -8.0605227423e-06 |    -1.3773227123e+06 |             1 |     1928
  720 |    -7.5967203945e-06 |    -1.3773680769e+06 |             2 |     1928
  740 |    -7.8931443561e-06 |    -1.3774087201e+06 |             2 |     1919
  760 |    -8.1793114232e-06 |    -1.3774478420e+06 |             1 |     1919
  780 |    -7.0407308072e-06 |    -1.3774840057e+06 |             4 |     1923
  800 |    -7.7064789812e-06 |    -1.3775212513e+06 |             1 |     1918
  820 |    -6.6699093878e-06 |    -1.3775554190e+06 |             4 |     1922
  840 |    -7.2125706534e-06 |    -1.3775906403e+06 |             1 |     1915
  860 |    -6.2779113080e-06 |    -1.3776231093e+06 |             4 |     1919
  880 |    -6.7875162931e-06 |    -1.3776566004e+06 |             2 |     1911
  900 |    -5.9760390702e-06 |    -1.3776875738e+06 |             1 |     1915
  920 |    -5.7651490990e-06 |    -1.3777217361e+06 |             4 |     1910
  940 |    -6.3260254739e-06 |    -1.3777522303e+06 |             1 |     1904
  960 |    -5.7922556888e-06 |    -1.3777807009e+06 |             2 |     1901
  980 |    -5.2697919572e-06 |    -1.3778084362e+06 |             2 |     1907

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
 1000 |    -5.6502408601e-06 |    -1.3778370030e+06 |             1 |     1897
 1000 |     5.6502408601e-06 |    -1.3778370030e+06 |             1 |     1897


FISTA: did not converge after 1000 iterations
FISTA: Relative error: 5.65024086e-06
Using new beta0 = 7.685169722e-10
Computing standardization and regularization values...
Computing standardization matrix...
100/100
Computing lambda and lambdaI...
100/100
lambda = 1.8490945546e+00
lambdaI = 5.5800326585e+07

Computing static estimate...
************************************* FISTA ************************************
A: 262144x263168 matrix, u: 262144 vector, b: 262144 vector
lambda:1.849094555, tol:1e-10
********************************************************************************

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
   20 |    -5.1005890909e-03 |    -1.3213468271e+06 |             4 |     1894
   40 |    -6.9313242742e-04 |    -1.3261755653e+06 |             4 |     1895
   60 |    -2.8153052007e-04 |    -1.3277834244e+06 |             4 |     1893
   80 |    -1.8244665263e-04 |    -1.3287781107e+06 |             1 |     1890
  100 |    -1.0660816822e-04 |    -1.3293940631e+06 |             1 |     1890
  120 |    -9.4522787882e-05 |    -1.3298495649e+06 |             1 |     1890
  140 |    -7.0614246143e-05 |    -1.3302054630e+06 |           0.5 |     1889
  160 |    -5.6130180692e-05 |    -1.3304758343e+06 |           0.5 |     1888
  180 |    -4.6356605290e-05 |    -1.3306957725e+06 |           0.5 |     1888
  200 |    -3.7651463113e-05 |    -1.3308807139e+06 |             1 |     1887
  220 |    -3.3520416538e-05 |    -1.3310473391e+06 |             1 |     1888
  240 |    -3.0611047052e-05 |    -1.3311988557e+06 |             1 |     1888
  260 |    -2.9737173378e-05 |    -1.3313393977e+06 |             1 |     1886
  280 |    -2.8123439376e-05 |    -1.3314723020e+06 |             1 |     1884
  300 |    -2.8447519767e-05 |    -1.3315991742e+06 |             1 |     1872
  320 |    -2.7382280895e-05 |    -1.3317217612e+06 |           0.5 |     1865
  340 |    -2.6675250387e-05 |    -1.3318410537e+06 |           0.5 |     1836
  360 |    -2.6152341548e-05 |    -1.3319576221e+06 |           0.5 |     1804
  380 |    -2.5766692094e-05 |    -1.3320720759e+06 |           0.5 |     1756
  400 |    -2.5439228081e-05 |    -1.3321848309e+06 |             1 |     1735
  420 |    -2.5055761497e-05 |    -1.3322960245e+06 |           0.5 |     1699
  440 |    -2.2778558077e-05 |    -1.3323988076e+06 |           0.5 |     1665
  460 |    -2.2499405298e-05 |    -1.3324987201e+06 |           0.5 |     1634
  480 |    -2.0533534774e-05 |    -1.3325916915e+06 |           0.5 |     1610
  500 |    -1.7716467412e-05 |    -1.3326738584e+06 |             1 |     1574
  520 |    -1.7287979520e-05 |    -1.3327507349e+06 |           0.5 |     1546
  540 |    -1.7042261727e-05 |    -1.3328262130e+06 |           0.5 |     1530
  560 |    -1.6835650984e-05 |    -1.3329005488e+06 |           0.5 |     1507
  580 |    -1.4381260538e-05 |    -1.3329697412e+06 |           0.5 |     1477
  600 |    -1.5187407787e-05 |    -1.3330379120e+06 |             1 |     1448
  620 |    -1.0880014454e-05 |    -1.3330864202e+06 |             2 |     1439
  640 |    -8.1249491241e-06 |    -1.3331270767e+06 |             2 |     1428
  660 |    -8.7861626929e-06 |    -1.3331658796e+06 |           0.5 |     1407
  680 |    -6.8869056509e-06 |    -1.3332004387e+06 |             1 |     1392
  700 |    -6.9810043121e-06 |    -1.3332361597e+06 |             1 |     1378
  720 |    -7.4687203243e-06 |    -1.3332779930e+06 |             2 |     1356
  740 |    -7.2099775027e-06 |    -1.3333136094e+06 |             2 |     1353
  760 |    -6.3995083344e-06 |    -1.3333456300e+06 |             1 |     1334
  780 |    -6.7420056821e-06 |    -1.3333793143e+06 |             2 |     1325
  800 |    -5.9337674245e-06 |    -1.3334096009e+06 |             1 |     1315
  820 |    -7.6191000581e-06 |    -1.3334536554e+06 |             4 |     1307
  840 |    -6.8021583934e-06 |    -1.3334881852e+06 |             2 |     1284
  860 |    -3.8964254615e-06 |    -1.3335083897e+06 |             1 |     1271
  880 |    -4.7021394106e-06 |    -1.3335301260e+06 |             2 |     1259
  900 |    -4.2100201918e-06 |    -1.3335492761e+06 |             1 |     1251
  920 |    -3.9388728190e-06 |    -1.3335682259e+06 |             2 |     1247
  940 |    -3.2504905393e-06 |    -1.3335869915e+06 |             2 |     1241
  960 |    -3.2297119216e-06 |    -1.3336056507e+06 |             2 |     1237
  980 |    -3.0535307693e-06 |    -1.3336239401e+06 |             4 |     1229

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
 1000 |    -3.6682841127e-06 |    -1.3336431280e+06 |             1 |     1214
 1000 |     3.6682841127e-06 |    -1.3336431280e+06 |             1 |     1214


FISTA: did not converge after 1000 iterations
FISTA: Relative error: 3.668284113e-06

Getting non zero elements...
Generating non zero elements operator...
100/100
Generating the new beta estimates...
************************************* FISTA ************************************
A: 262144x1214 matrix, u: 262144 vector, b: 262144 vector
lambda:0, tol:1e-10
********************************************************************************

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
   20 |    -1.0238337490e-03 |    -1.3680452190e+06 |             1 |     1214
   40 |    -5.8674716582e-04 |    -1.3708843275e+06 |             1 |     1214
   60 |    -1.4697707568e-04 |    -1.3720035578e+06 |             2 |     1214
   80 |    -1.1398760040e-04 |    -1.3730953419e+06 |             4 |     1214
  100 |    -1.3467546425e-04 |    -1.3739638703e+06 |             1 |     1214
  120 |    -1.5183326025e-04 |    -1.3746730839e+06 |             4 |     1214
  140 |    -1.1155946632e-04 |    -1.3750926353e+06 |             4 |     1214
  160 |    -9.9444695577e-05 |    -1.3754775679e+06 |             4 |     1214
  180 |    -2.8746353726e-05 |    -1.3756627222e+06 |             4 |     1214
  200 |    -4.4877482748e-05 |    -1.3759590387e+06 |             1 |     1210
  220 |    -2.2029065390e-05 |    -1.3761550270e+06 |             2 |     1207
  240 |    -4.5516881342e-05 |    -1.3762963661e+06 |          0.25 |     1207
  260 |    -4.6713469294e-05 |    -1.3765053929e+06 |             2 |     1211
  280 |    -1.5861563758e-05 |    -1.3766179012e+06 |             2 |     1207
  300 |    -2.6603305972e-05 |    -1.3767840458e+06 |             1 |     1209
  320 |    -2.3463818830e-05 |    -1.3769462908e+06 |             2 |     1208
  340 |    -1.2192745336e-05 |    -1.3770743842e+06 |             2 |     1207
  360 |    -1.0314472263e-05 |    -1.3771268456e+06 |             2 |     1207
  380 |    -9.8211120539e-06 |    -1.3771767837e+06 |             2 |     1207
  400 |    -9.3616468413e-06 |    -1.3772243739e+06 |             1 |     1207
  420 |    -1.5825236070e-05 |    -1.3772904288e+06 |             1 |     1206
  440 |    -1.0101962206e-05 |    -1.3773708070e+06 |             2 |     1207
  460 |    -7.5719353387e-06 |    -1.3774092391e+06 |             2 |     1205
  480 |    -7.2532942426e-06 |    -1.3774460498e+06 |             2 |     1205
  500 |    -6.8931731599e-06 |    -1.3774811858e+06 |             1 |     1204
  520 |    -7.0499946323e-06 |    -1.3775153390e+06 |             1 |     1204
  540 |    -1.6679760871e-05 |    -1.3775831934e+06 |           0.5 |     1207
  560 |    -1.5965080073e-05 |    -1.3776528378e+06 |          0.25 |     1203
  580 |    -1.9151664309e-05 |    -1.3777298108e+06 |           0.5 |     1206
  600 |    -4.3905548948e-06 |    -1.3777664989e+06 |             1 |     1208
  620 |    -4.3193210728e-06 |    -1.3778034939e+06 |             2 |     1204
  640 |    -7.3297918103e-06 |    -1.3778293139e+06 |           0.5 |     1205
  660 |    -3.9814449645e-06 |    -1.3778541012e+06 |             2 |     1204
  680 |    -3.8577892071e-06 |    -1.3778736240e+06 |             2 |     1204
  700 |    -3.7381445764e-06 |    -1.3778925384e+06 |             1 |     1203
  720 |    -3.6240210626e-06 |    -1.3779108732e+06 |             2 |     1201
  740 |    -3.5155308053e-06 |    -1.3779286557e+06 |             2 |     1201
  760 |    -3.4117669455e-06 |    -1.3779459110e+06 |             2 |     1201
  780 |    -3.3120472156e-06 |    -1.3779626602e+06 |             2 |     1201
  800 |    -3.2151992220e-06 |    -1.3779789195e+06 |             1 |     1201
  820 |    -3.1187394920e-06 |    -1.3779946946e+06 |             2 |     1201
  840 |    -8.9326220087e-06 |    -1.3780310864e+06 |          0.25 |     1198
  860 |    -2.8255999912e-06 |    -1.3780486518e+06 |             2 |     1199
  880 |    -4.8026212920e-06 |    -1.3780757600e+06 |             1 |     1199
  900 |    -6.9382780478e-06 |    -1.3781093883e+06 |             1 |     1197
  920 |    -2.3913814576e-06 |    -1.3781320949e+06 |             2 |     1196
  940 |    -2.3338878049e-06 |    -1.3781438805e+06 |             2 |     1196
  960 |    -2.1849414089e-06 |    -1.3781552331e+06 |             2 |     1198
  980 |    -2.1860666440e-06 |    -1.3781761350e+06 |             2 |     1198

 iter |          tol         |        FLasso        |      Lf       |   NNZ
--------------------------------------------------------------------------------
 1000 |    -4.6326452774e-06 |    -1.3781966447e+06 |             1 |     1197
 1000 |     4.6326452774e-06 |    -1.3781966447e+06 |             1 |     1197


FISTA: did not converge after 1000 iterations
FISTA: Relative error: 4.632645277e-06
Using new beta0 = 6.909959157e-10

Time for MC simulations: 631.0331013 seconds
Time for FISTA solver: 331.6650284 seconds
Time for GLM fit on non zero elements: 787.7571826 seconds
Time for MC simulations 2: 607.751539 seconds
Time for FISTA solver 2: 315.5834247 seconds
Time for GLM fit on non zero elements 2: 498.4972327 seconds


MATLAB result :
FISTA: converged in 1000 iterations (nnz(x)= 2984)
FISTA: Relative error: -1.34e-05
FISTA: Final FLasso value: -1.337219e+06
Elapsed time is 7952.558757 seconds.

Amount wrong : 3084 / 263168 ~= 1.171875%
0.9999999734 relative norm error.